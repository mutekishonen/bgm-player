<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini BGM Player</title>
<style>
  #bgm-player {
    position: fixed;
    bottom: 10px;
    right: 10px;
    background: rgba(30, 30, 30, 0.95);
    color: white;
    font-family: "Noto Sans KR", sans-serif;
    padding: 10px 15px;
    border-radius: 10px;
    box-shadow: 0 0 10px #000;
    display: flex;
    align-items: center;
    gap: 10px;
    z-index: 9999;
  }
  #bgm-player button {
    background: #ff7f50;
    border: none;
    border-radius: 5px;
    color: white;
    padding: 5px 10px;
    cursor: pointer;
    font-size: 14px;
  }
  #bgm-player button:hover { background: #ff9966; }
  #bgm-title {
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
</style>
</head>
<body>

<div id="bgm-player">
  <button id="prev">⏮</button>
  <button id="play">⏯</button>
  <button id="next">⏭</button>
  <span id="bgm-title">로딩 중...</span>
</div>

<audio id="audio" autoplay></audio>

<script>
const playlist = [
  { title: "GAL's Life! (feat. KOTONEHOUSE) - DENONBU", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/GAL's Life! (feat. KOTONOHOUSE....mp3" },
  { title: "DASH - NMIXX", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/DASH-1-NMIXX.mp3" },
  { title: "Password - 트리플에스", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/Password-1-트리플에스.mp3" },
  { title: "SOMETHING AIN’T RIGHT - XG", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/SOMETHING AIN'T RIGHT-1-XG.mp3" },
  { title: "Lucky Strike - Maroon 5", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/Lucky Strike-4-Maroon 5.mp3" },
  { title: "プレイ - Giga", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/プレイ-1-Giga.mp3" }
];

const audio = document.getElementById("audio");
const titleElem = document.getElementById("bgm-title");
const playBtn = document.getElementById("play");
const nextBtn = document.getElementById("next");
const prevBtn = document.getElementById("prev");

let currentIndex = parseInt(localStorage.getItem("bgmIndex")) || 0;
let currentTime = parseFloat(localStorage.getItem("bgmTime")) || 0;

function loadSong(index) {
  const song = playlist[index];
  audio.src = song.url;
  audio.currentTime = currentTime;
  titleElem.textContent = song.title;
  audio.play().catch(()=>{}); // 자동재생 차단 대응
}

audio.addEventListener("ended", () => {
  currentIndex = (currentIndex + 1) % playlist.length;
  currentTime = 0;
  loadSong(currentIndex);
});

playBtn.addEventListener("click", () => {
  if(audio.paused) audio.play();
  else audio.pause();
});

nextBtn.addEventListener("click", () => {
  currentIndex = (currentIndex + 1) % playlist.length;
  currentTime = 0;
  loadSong(currentIndex);
});

prevBtn.addEventListener("click", () => {
  currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
  currentTime = 0;
  loadSong(currentIndex);
});

window.addEventListener("beforeunload", () => {
  localStorage.setItem("bgmIndex", currentIndex);
  localStorage.setItem("bgmTime", audio.currentTime);
});

window.addEventListener("load", () => {
  loadSong(currentIndex);
});
</script>

</body>
</html>
