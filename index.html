<!-- 티스토리용 세련된 미니 BGM 플레이어 -->
<div id="tistory-bgm-player" style="
  position: fixed; bottom: 20px; right: 20px;
  background: rgba(0,0,0,0.6); color: white;
  padding: 10px 16px; border-radius: 18px;
  font-family: 'Noto Sans KR', sans-serif;
  display: flex; align-items: center; gap: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
  z-index: 9999; width: 280px; overflow: hidden;
">
  <!-- 파도 애니메이션 -->
  <div id="wave" style="display: flex; align-items: flex-end; gap: 2px;">
    <div class="bar" style="width: 2px; height: 6px; background: #fff; opacity: 0.8;"></div>
    <div class="bar" style="width: 2px; height: 10px; background: #fff; opacity: 0.8;"></div>
    <div class="bar" style="width: 2px; height: 14px; background: #fff; opacity: 0.8;"></div>
    <div class="bar" style="width: 2px; height: 10px; background: #fff; opacity: 0.8;"></div>
    <div class="bar" style="width: 2px; height: 6px; background: #fff; opacity: 0.8;"></div>
  </div>

  <!-- 곡 제목 (스크롤 효과) -->
  <div style="flex: 1; overflow: hidden;">
    <div id="bgm-title" style="
      white-space: nowrap;
      display: inline-block;
      animation: scrollTitle 12s linear infinite;
      font-size: 14px;
    ">로딩 중...</div>
  </div>

  <!-- 버튼들 -->
  <button id="bgm-prev" style="background:none; border:none; color:white; font-size:16px; cursor:pointer;">⏮</button>
  <button id="bgm-play" style="background:none; border:none; color:white; font-size:16px; cursor:pointer;">🔇</button>
  <button id="bgm-next" style="background:none; border:none; color:white; font-size:16px; cursor:pointer;">⏭</button>
  <audio id="bgm-audio" muted autoplay></audio>
</div>

<!-- 🎵 제목 스크롤 애니메이션 -->
<style>
@keyframes scrollTitle {
  0% { transform: translateX(100%); }
  100% { transform: translateX(-100%); }
}

/* 파도 애니메이션 */
@keyframes waveMotion {
  0% { transform: scaleY(1); }
  50% { transform: scaleY(2.2); }
  100% { transform: scaleY(1); }
}
.bar {
  animation: waveMotion 1s ease-in-out infinite;
  transform-origin: bottom;
}
.bar:nth-child(1) { animation-delay: 0s; }
.bar:nth-child(2) { animation-delay: 0.1s; }
.bar:nth-child(3) { animation-delay: 0.2s; }
.bar:nth-child(4) { animation-delay: 0.3s; }
.bar:nth-child(5) { animation-delay: 0.4s; }
</style>

<script>
const playlist = [
  { title: "GAL's Life! (feat. KOTONEHOUSE) - DENONBU", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/GAL's Life! (feat. KOTONOHOUSE....mp3" },
  { title: "DASH - NMIXX", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/DASH-1-NMIXX.mp3" },
  { title: "Password - 트리플에스", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/Password-1-트리플에스.mp3" },
  { title: "SOMETHING AIN’T RIGHT - XG", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/SOMETHING AIN'T RIGHT-1-XG.mp3" },
  { title: "Lucky Strike - Maroon 5", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/Lucky Strike-4-Maroon 5.mp3" },
  { title: "プレイ - Giga", url: "https://raw.githubusercontent.com/mutekishonen/bgm-player/main/プレイ-1-Giga.mp3" }
];

const audio = document.getElementById("bgm-audio");
const titleEl = document.getElementById("bgm-title");
const playBtn = document.getElementById("bgm-play");
const nextBtn = document.getElementById("bgm-next");
const prevBtn = document.getElementById("bgm-prev");
const bars = document.querySelectorAll(".bar");

let currentIndex = parseInt(localStorage.getItem("bgmIndex")) || 0;

function loadSong(index) {
  const song = playlist[index];
  titleEl.textContent = song.title;
  audio.src = song.url;
  audio.play().catch(() => console.log("자동재생 제한됨 (무음으로 시작)"));
}

function updateIcon() {
  if (audio.paused) playBtn.textContent = "▶";
  else if (audio.muted) playBtn.textContent = "🔇";
  else playBtn.textContent = "🔊";
}

function toggleWave(active) {
  bars.forEach(bar => {
    bar.style.animationPlayState = active ? "running" : "paused";
    bar.style.opacity = active ? "1" : "0.4";
  });
}

playBtn.addEventListener("click", () => {
  if (audio.muted) {
    audio.muted = false;
    updateIcon();
  } else if (audio.paused) {
    audio.play();
    updateIcon();
  } else {
    audio.pause();
    updateIcon();
  }
});

nextBtn.addEventListener("click", () => {
  currentIndex = (currentIndex + 1) % playlist.length;
  loadSong(currentIndex);
});

prevBtn.addEventListener("click", () => {
  currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
  loadSong(currentIndex);
});

audio.addEventListener("ended", () => {
  currentIndex = (currentIndex + 1) % playlist.length;
  loadSong(currentIndex);
});

audio.addEventListener("play", () => toggleWave(true));
audio.addEventListener("pause", () => toggleWave(false));

window.addEventListener("load", () => {
  loadSong(currentIndex);
  updateIcon();
  toggleWave(true);
});
</script>

